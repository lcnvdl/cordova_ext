function waitUntil(condition,callback,delay){delay=delay||50,condition()?callback():setTimeout(function(){waitUntil(condition,callback,delay)},delay)}function waitWhile(condition,callback,delay){delay=delay||50,condition()?setTimeout(function(){waitWhile(condition,callback,delay)},delay):callback()}var $c=$c||function(callback,delay){var fn;fn=delay>0?function(){setTimeout(callback,delay)}:callback,$(document).on("on-device-ready",fn)},$cb=$cb||function(callback){$(document).on("on-device-ready-before",callback)},$cl=$cl||function(callback){$(document).on("on-device-ready-after",callback)},Cordova={currentApp:null,startApp:function(callback){var app={initialize:function(){Cordova.isMobile()?document.addEventListener("deviceready",this.onDeviceReady.bind(this),!1):$(app.onDeviceReady.bind(app))},onDeviceReady:function(){try{"function"==typeof callback&&callback()}catch(e){alert(e),console.log(e)}$(document).trigger("on-device-ready-before"),$(document).trigger("on-device-ready"),setTimeout(function(){$(document).trigger("on-device-ready-after")},500)}};Cordova.currentApp=app,app.initialize()},isMobile:function(){return(window.cordova||window.PhoneGap||window.phonegap)&&/^file:\/{3}[^\/]/i.test(window.location.href)&&/ios|iphone|ipod|ipad|android/i.test(navigator.userAgent)},isBrowser:function(){return!Cordova.isMobile()}};$c(function(){var load=function(e,id){var p=e.data(void 0===id?"autoload":"autoload-"+id),mode=e.data("mode"),style=e.data("style")||"",_class=e.data("class")||"";$.ajax({url:p,type:"GET",cache:!1,async:!1}).done(function(html){if(e.html(html),"replace"===mode){var c=e.children().insertBefore(e);e.remove(),e=c}""!=e.attr("style")&&(style=e.attr("style")+";"+style),e.attr("style",style).addClass("class",_class)}).fail(function(a,b,c){alert("Error: "+c),console.log([a,b,c])})},autoload=function(){var again=!1;$("[data-autoload]").each(function(){var e=$(this);e.data("autoloaded")||(e.data("autoloaded",!0),load(e))}),Cordova.isMobile()?$("[data-autoload-mobile]").each(function(){var e=$(this);e.data("autoloaded")||(e.data("autoloaded",!0),load(e,"mobile"),again=!0)}):$("[data-autoload-browser]").each(function(){var e=$(this);e.data("autoloaded")||(e.data("autoloaded",!0),load(e,"browser"),again=!0)}),again?setTimeout(autoload,50):$(document).trigger("template-load")};autoload()});var JobQueue=function(maxJobs){var currentJobs=0,queue=[],tout=0,self=this,inactive=!0;this.activeEvent=[],this.inactiveEvent=[],this.maxJobs=maxJobs||3,this.add=function(work){queue.push(work)},this.stop=function(){tout&&(clearTimeout(tout),tout=0)},this.process=function(){if(queue.length>0&&currentJobs<this.maxJobs){inactive=!1;for(var i=0;i<this.activeEvent.length;i++)this.activeEvent[i]();for(;queue.length>0&&currentJobs<this.maxJobs;){currentJobs++;queue.shift()(function(){currentJobs--,self.process()})}}else if(tout&&(clearTimeout(tout),tout=0),tout=setTimeout(function(){self.process()},1e3),0===queue.length)for(var i=0;i<this.inactiveEvent.length;i++)this.inactiveEvent[i]()},this.process()};$c(function(){var hash=null,check=function(){null==hash?hash=location.hash:location.hash!=hash&&$(document).trigger("navigation-go",[hash]),setTimeout(check,500)};setTimeout(check,500)});var Facebook=function(){var fb="undefined"!=typeof FB?FB:facebookConnectPlugin;if(!fb)throw"Cannot find Facebook SDK.";var mobile="undefined"!=typeof facebookConnectPlugin,permissions=["public_profile","user_birthday","email","user_friends"];this.login=function(callback){fb.login(permissions,function(a){callback&&callback(!0,a)},function(a){callback&&callback(!1,a)})};var fbApi=function(url,apiPermissions,callback){mobile?fb.api(url,apiPermissions,function(res){callback({success:!0,response:res})},function(err){callback({success:!1,response:err})}):fb.api(url,function(res){callback({success:!!res&&!res.error,response:res})})};this.getLoggedAccount=function(callback){var success=function(response){"connected"===response.status?fbApi("/me",["public_profile","user_birthday","email"],function(dataResponse){if(dataResponse.success){dataResponse=dataResponse.response,console.log("Successful login for: "+dataResponse.name),console.log(dataResponse);fbApi("/me/friends",["public_profile","user_friends"],function(friendsResponse){if(friendsResponse.success){friendsResponse=friendsResponse.response;var account=new Account({id:dataResponse.id,fullname:dataResponse.name||"unknown",email:dataResponse.email,friends:friendsResponse.data,photograph:"http://graph.facebook.com/"+dataResponse.id+"/picture?type=normal"});callback({success:!0,account:account,status:response.status})}else callback({success:!1,account:null,status:friendsResponse.response.status,message:friendsResponse.response})})}else callback({success:!1,account:null,status:dataResponse.response.status,message:dataResponse.response})}):callback({success:!1,account:null,status:response.status,message:"ConexiÃ³n perdida"})};mobile?fb.getLoginStatus(success,function(err){callback({success:!1,account:null,status:response.status,message:err})}):fb.getLoginStatus(success,!0)},this.publishPhoto=function(){fb.showDialog({method:"feed",picture:"https://www.google.co.jp/logos/doodles/2014/doodle-4-google-2014-japan-winner-5109465267306496.2-hp.png",name:"Test Post",message:"First photo post",caption:"Testing using phonegap plugin",description:"Posting photo using phonegap facebook plugin"},function(response){alert(JSON.stringify(response))},function(response){alert(JSON.stringify(response))})},this.logout=function(){}};